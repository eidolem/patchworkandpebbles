<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
    {{!-- Document Settings --}}
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />


    {{!-- Page Meta --}}
    <title>{{meta_title}}</title>
    <meta name="description" content="{{meta_description}}" />


    {{!-- Mobile Meta --}}
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />


    {{!-- Styles'n'Scripts --}}
    {{!-- ***replace with minimized file! *** --}}
    <link rel="stylesheet" type="text/css" href="{{asset "css/vendor/materialize.css"}}"  media="screen,projection"/>
    {{!-- *** replace with minimized file! *** --}}
    <link rel="stylesheet" type="text/css" href="{{asset "css/application.css"}}" />
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:300,400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans:400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Aldrich" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Satisfy" rel="stylesheet">

    {{!-- Ghost outputs important style and meta data with this tag --}}
    {{ghost_head}}

    {{!-- jQuery needs to come before `{{ghost_foot}}` so that jQuery can be used in code injection --}}
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>

    {{!-- AdSense regular ad slots --}}
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    {{!-- AdSense mobile page-level ads --}}
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-2599762387787801",
      enable_page_level_ads: true
      });
    </script>

    <!-- MailChimp -->
    {{!-- <link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css"> --}}
</head>

<body class="{{body_class}}">
    {{!-- All the main content gets inserted here, index.hbs, post.hbs, etc --}}
    {{navigation}}
    <main role="main" class="page-content">
      {{{body}}}
    </main>
    {{> footer}}

    {{!-- Ghost outputs important scripts and data with this tag --}}
    {{ghost_foot}}

    {{!-- Fitvids makes video embeds responsive and awesome --}}
    <script type="text/javascript" src="{{asset "js/fitvids.js"}}"></script>
    
    {{!-- For materialize --}}
    <script type="text/javascript" src="{{asset "js/bin/materialize.min.js"}}"></script>
    <script type="text/javascript">
        $( document ).ready(function(){
            $(".button-collapse").sideNav();
            $(".post-content").fitVids();
            // Functions for scroll events. Check every 250ms instead of every pixel scroll.
            // Much less expensive to compute every function.
            var didScroll;
            $(document).scroll(function() {
                didScroll = true;
            });
            // Set the interval to 250ms, and call scroll functions, and reset boolean
            setInterval (function(){
                if(didScroll) {
                    showHideSubscribePopup();
                    showHideMobileNav();
                    didScroll = false;
                }
            }, 250);
            // For email subscribe popup
            function showHideSubscribePopup () {
                // y_pos is where the user is scrolled to
                var y_pos = window.pageYOffset; 
                // y_pos_break is where classes are added or removed to hide element
                var y_pos_break = $('#post-content').height() / 2;
                if (y_pos<y_pos_break) {
                  $("#email-subscribe-popup").addClass('hide');
                }
                else {
                  $("#email-subscribe-popup").removeClass('hide');
                }
            }
            // For mobile nav header
            // Ref: https://medium.com/@mariusc23/hide-header-on-scroll-down-show-on-scroll-up-67bbaae9a78c
            var lastScrollTop = 0;
            var delta=5;
            var navbarHeight = 70;
            function showHideMobileNav() {
                // Current scroll location
                var currScroll = $(this).scrollTop();
                // If they haven't scrolled more than delta, return and don't do anything
                if(Math.abs(lastScrollTop-currScroll) <= delta) {
                    return;
                }
                //If they scrolled past the navbar, remove fixed class. Required so you never see what's "behind" the navbar
                if(currScroll>lastScrollTop && currScroll>navbarHeight){
                    $('#nav-small-med').removeClass('navbar-fixed');
                }
                //Else if user didn't scroll past document (possible on a mac)
                else {
                    if(currScroll + $(window).height() < $(document).height()) {
                        $('#nav-small-med').addClass('navbar-fixed');
                    }
                }
                lastScrollTop = currScroll;
            }
          });

    </script>

    {{!-- For masonry layout for index and tag pages https://masonry.desandro.com/ --}}
    <script type="text/javascript" src="{{asset "js/masonry.js"}}"></script>
    <script type="text/javascript" src="{{asset "js/imagesloaded.js"}}"></script>
    <script type="text/javascript">
      var $grid = $('.grid').masonry({
        itemSelector: '.grid-item',
        columnWidth: '.grid-sizer',
        percentPosition: true, 
        gutter: '.gutter-sizer',
        stagger: 30
      });
      // layout Masonry after each image loads
      $grid.imagesLoaded().progress( function() {
        $grid.masonry();
      });  
    </script>

    {{!-- Masonry layout for home page --}}
    <script type="text/javascript">
      var $grid = $('.grid-home').masonry({
        itemSelector: '.grid-item-home',
        columnWidth: '.grid-sizer-home',
        percentPosition: true, 
        gutter: '.gutter-sizer-home',
        horizontalOrder: true,
        stagger: 30
      });
      // layout Masonry after each image loads
      $grid.imagesLoaded().progress( function() {
        $grid.masonry();
      });  
    </script>

    {{!-- For button close, remove element from DOM --}}
    <script>
      function closeMe(elementToClose) {
        $(elementToClose).remove();
      }
    </script>


    {{!-- For the back-to-top arrow --}}
     <script>
    //     (function($) {
    //       ScrollToTop = {
    //         setup: function() {
    //           var $window = $(window),
    //               $scrollToTopButton = $('<div id="scroll-to-top"></div>').appendTo('body');

    //           $scrollToTopButton.on('click touchstart', function() {
    //             $('body, html').animate({ scrollTop: 0 }, 300);
    //           });

    //           // show and hide scroll to top button logic
    //           $window.on('scroll.scroll-to-top', function() {
    //             var threshold = 50,
    //                 duration = 200;

    //             if ($window.scrollTop() >= threshold && $scrollToTopButton.is(':hidden')) {
    //               $scrollToTopButton.fadeIn(duration);
    //             } else if ($window.scrollTop() < threshold && $scrollToTopButton.is(':visible')) {
    //               $scrollToTopButton.fadeOut(duration);
    //             }
    //           });

    //           // Mousewheel events don't work through position-fixed elements. This is a fix.
    //           // http://stackoverflow.com/questions/7182502/pass-mousewheel-event-through-fixed-content
    //           $scrollToTopButton.on('mousewheel DOMMouseScroll', function(e) {
    //             var originalEvent = e.originalEvent,
    //                 wheelDelta;

    //             if (originalEvent.wheelDelta) {
    //               wheelDelta = originalEvent.wheelDelta * -1;
    //             } else if (originalEvent.detail) {
    //               wheelDelta = originalEvent.detail * 15;
    //             }

    //             var scrollTo = wheelDelta + $window.scrollTop();
    //             $window.scrollTop(scrollTo);
    //           });
    //         },

    //         teardown: function() {
    //           $(window).off('scroll.scroll-to-top');
    //           $('#scroll-to-top').remove();
    //         }
    //       }
    //     }(jQuery));

    //     ScrollToTop.setup();
    // </script>

</body>
</html>
